{% extends 'base.html' %}
{% block content %}
<section class="max-w-3xl mx-auto space-y-6">
  <div class="bg-gradient-to-r from-pink-900/20 to-purple-900/20 p-6 rounded-lg border border-pink-700/30">
    <div class="flex items-start justify-between mb-4">
      <div class="flex items-center gap-3">
        {% if roast.user %}
        <img src="{{ roast.user.picture }}" class="w-12 h-12 rounded-full border-2 border-pink-500"
          alt="{{ roast.user.name }}" />
        <div>
          <h2 class="font-semibold text-lg">{{ roast.user.name }}</h2>
          <p class="text-xs text-slate-400">{{ roast.created_at.strftime('%B %d, %Y at %I:%M %p') }}</p>
        </div>
        {% else %}
        <div class="w-12 h-12 rounded-full bg-slate-700 flex items-center justify-center">
          <span class="text-2xl">ðŸ‘¤</span>
        </div>
        <div>
          <h2 class="font-semibold text-lg">Anonymous</h2>
          <p class="text-xs text-slate-400">{{ roast.created_at.strftime('%B %d, %Y at %I:%M %p') }}</p>
        </div>
        {% endif %}
      </div>

      <div class="flex gap-2">
        {% if roast.sources %}
        <div class="flex gap-1">
          {% for source in roast.sources %}
          <span class="px-2 py-1 bg-slate-800 rounded text-xs border border-slate-700">{{ source }}</span>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </div>

    <div class="bg-slate-900/50 p-5 rounded border border-slate-700">
      <h1 class="text-2xl font-bold mb-4 text-pink-400">ðŸ”¥ The Roast</h1>
      <p class="text-slate-100 leading-relaxed whitespace-pre-line">{{ roast.roast_text }}</p>
    </div>

    {% if roast.inputs %}
    <div class="mt-4 pt-4 border-t border-slate-700">
      <h3 class="text-sm font-medium text-slate-400 mb-2">Roasted Profile:</h3>
      <div class="flex gap-3 text-sm">
        {% if roast.inputs.valorant_name %}
        <span class="px-3 py-1 bg-slate-800 rounded">ðŸŽ® {{ roast.inputs.valorant_name }}#{{ roast.inputs.valorant_tag
          }}</span>
        {% endif %}
        {% if roast.inputs.anilist_user %}
        <span class="px-3 py-1 bg-slate-800 rounded">ðŸ“º {{ roast.inputs.anilist_user }}</span>
        {% endif %}
      </div>
    </div>
    {% endif %}
  </div>

  <div class="flex gap-3 justify-center">
    <button onclick="copyShareUrl()" class="px-5 py-2.5 bg-blue-600 hover:bg-blue-500 rounded font-medium transition">
      ðŸ“¤ Copy Share Link
    </button>
    <a href="/" class="px-5 py-2.5 bg-pink-600 hover:bg-pink-500 rounded font-medium transition">
      âœ¨ Create Your Own Roast
    </a>
  </div>

  <details class="bg-slate-800/30 p-4 rounded border border-slate-700 text-xs">
    <summary class="cursor-pointer text-slate-200 font-medium">View Raw Data</summary>
    <pre class="mt-3 overflow-x-auto bg-slate-900 p-3 rounded">{{ roast.raw_data | tojson(indent=2) }}</pre>
  </details>
</section>

<script>
  function copyShareUrl() {
    const url = window.location.href;
    navigator.clipboard.writeText(url).then(() => {
      const btn = event.target;
      const originalText = btn.textContent;
      btn.textContent = 'âœ“ Copied!';
      btn.classList.add('bg-green-600');
      setTimeout(() => {
        btn.textContent = originalText;
        btn.classList.remove('bg-green-600');
        btn.classList.add('bg-blue-600');
      }, 2000);
    });
  }
</script>
{% endblock %}
